<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LEGO Satellite Commander</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/satellite.js/4.1.3/satellite.min.js"></script>
    <style>
        body { background-color: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', sans-serif; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        
        /* UI Cards */
        .card { background: #1e293b; padding: 20px; border-radius: 16px; margin-bottom: 20px; border: 1px solid #334155; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        h1 { color: #60a5fa; margin-top: 0; }
        h3 { border-bottom: 1px solid #475569; padding-bottom: 10px; margin-top: 0; color: #94a3b8; }
        
        /* Buttons */
        button { padding: 15px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; width: 100%; transition: 0.2s; color: white; font-size: 16px; margin-top: 10px; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-blue { background: #3b82f6; } .btn-blue:hover { background: #2563eb; }
        .btn-green { background: #10b981; } .btn-green:hover { background: #059669; }
        .btn-red { background: #ef4444; }
        
        /* Inputs */
        input { background: #334155; border: 1px solid #475569; color: white; padding: 10px; border-radius: 8px; width: 80px; text-align: center; margin: 5px; }

        /* RADAR SCREEN */
        #radar { 
            width: 280px; height: 280px; 
            background: radial-gradient(circle, #0f172a 0%, #020617 100%);
            border-radius: 50%; border: 2px solid #334155; 
            margin: 20px auto; position: relative; overflow: hidden; 
        }
        .grid-line { position: absolute; background: #334155; }
        .grid-ring { position: absolute; border: 1px solid #334155; border-radius: 50%; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .label { position: absolute; font-size: 12px; color: #64748b; font-weight: bold; }
        
        /* THE TARGET DOT */
        #dot { 
            width: 16px; height: 16px; background: #00ff00; 
            border-radius: 50%; position: absolute; 
            box-shadow: 0 0 15px #00ff00; 
            display: none; 
            transition: top 0.5s, left 0.5s; 
            transform: translate(-50%, -50%); /* Centers the dot on coords */
        }
        
        .data-display { font-size: 1.2em; color: #fbbf24; font-weight: bold; }
        #log { font-family: monospace; color: #22c55e; font-size: 0.9em; margin-top: 10px; min-height: 1.2em; }
    </style>
</head>
<body>

<div class="container">
    <h1>üõ∞Ô∏è LEGO Satellite Commander</h1>

    <div class="card">
        <h3>1. Mission Prep</h3>
        <div>
            <input id="lat" placeholder="Lat">
            <input id="lon" placeholder="Lon">
            <button class="btn-blue" style="width: auto;" onclick="getLocation()">üìç Detect</button>
        </div>
        <button class="btn-blue" onclick="downloadData()">üì• Download Satellite Data</button>
        <div id="dataStatus" style="color: #fbbf24; margin-top: 10px;">Waiting for data...</div>
    </div>

    <div class="card">
        <h3>2. Mission Control</h3>
        <p style="color: #94a3b8; font-size: 0.9em;">Turn on Robot. Wait for Blue Pulse.</p>
        
        <button id="btnConnect" class="btn-green" onclick="connectAndStart()">üì° Connect & Start Mission</button>
        
        <h2 id="satName" style="color: #60a5fa; margin: 15px 0; min-height: 1.2em;">-- STANDBY --</h2>
        <div style="display:flex; justify-content:space-between; padding: 0 40px;">
            <span>Az: <span id="valAz" class="data-display">0</span>¬∞</span>
            <span>El: <span id="valEl" class="data-display">0</span>¬∞</span>
